<%= turbo_frame_tag "strong-definition-modal" do %>
  <% if @strong %>
    <div class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center"
         data-controller="modal"
         data-modal-target="backdrop"
         data-action="click->modal#closeOnOutside keydown@document->modal#handleEscape">

      <div class="bg-gray-800 border-2 border-yellow-400 rounded-xl p-6 lg:p-8 max-w-4xl w-full mx-4 shadow-2xl max-h-[90vh] overflow-y-auto"
           onclick="event.stopPropagation()">

        <div class="flex justify-between items-center mb-4 lg:mb-6 pb-4 lg:pb-6 border-b border-gray-600">
          <div>
            <h2 class="text-xl lg:text-3xl font-bold text-yellow-400 mb-2">
              Strong's <%= @strong.display_number %>
            </h2>
            <h3 class="text-lg lg:text-2xl font-semibold text-sky-300 mb-2">
              <%= @strong.greek_word %>
            </h3>
            <% if @strong.pronunciation.present? %>
              <p class="text-base lg:text-xl text-gray-300 italic">
                Pronunciaci√≥n: <%= @strong.pronunciation %>
              </p>
            <% end %>
          </div>

          <%= link_to "‚úï",
              "#",
              class: "text-gray-400 hover:text-white text-2xl font-bold leading-none ml-4",
              title: "Cerrar",
              data: { action: "click->modal#close" } %>
        </div>

        <!-- Main Definition -->
        <div class="mb-4 lg:mb-6">
          <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">Definici√≥n:</h4>
          <div class="text-base lg:text-lg text-gray-200 leading-relaxed space-y-2">
            <% if @strong.definition.present? %>
              <p><%= @strong.definition %></p>
            <% end %>
            <% if @strong.definition2.present? %>
              <p class="text-gray-300"><%= @strong.definition2 %></p>
            <% end %>
            <% if @strong.definition.blank? && @strong.definition2.blank? %>
              <p class="text-gray-400 italic">No hay definici√≥n disponible.</p>
            <% end %>
          </div>
        </div>

        <!-- Grammatical Information -->
        <% if @strong.part_of_speech.present? %>
          <div class="mb-4 lg:mb-6">
            <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">Informaci√≥n Gramatical:</h4>
            <span class="inline-block bg-blue-600 text-blue-100 px-3 py-1 rounded-lg text-sm lg:text-base font-medium">
              <%= @strong.part_of_speech %>
            </span>
          </div>
        <% end %>

        <!-- Etymology/Derivation -->
        <% if @strong.derivation.present? %>
          <div class="mb-4 lg:mb-6">
            <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">Etimolog√≠a:</h4>
            <p class="text-base lg:text-lg text-gray-300 leading-relaxed">
              <%= @strong.derivation %>
            </p>
          </div>
        <% end %>

        <!-- Reina Valera 1909 Definition (if available) -->
        <% if @strong.rv1909_definition.present? %>
          <div class="mb-4 lg:mb-6">
            <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">Definici√≥n RV1909:</h4>
            <p class="text-base lg:text-lg text-gray-300 leading-relaxed">
              <%= @strong.rv1909_definition %>
            </p>
          </div>
        <% end %>

        <!-- Usage Statistics -->
        <div class="mb-4 lg:mb-6">
          <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">Uso en las Escrituras:</h4>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="bg-gray-700 rounded-lg p-3 lg:p-4">
              <span class="text-sm lg:text-base text-gray-400">Total de apariciones:</span>
              <span class="block text-lg lg:text-xl font-semibold text-white">
                <%= @strong.word_count %> <%= @strong.word_count == 1 ? 'vez' : 'veces' %>
              </span>
            </div>
            <div class="bg-gray-700 rounded-lg p-3 lg:p-4">
              <span class="text-sm lg:text-base text-gray-400">En vers√≠culos √∫nicos:</span>
              <span class="block text-lg lg:text-xl font-semibold text-white">
                <%= @verses_with_word.count %> <%= @verses_with_word.count == 1 ? 'vers√≠culo' : 'vers√≠culos' %>
              </span>
            </div>
          </div>
        </div>

        <!-- Sample Verses -->
        <% if @verses_with_word.present? %>
          <div class="mb-4 lg:mb-6">
            <h4 class="text-lg lg:text-xl font-semibold text-white mb-3">
              Ejemplos de Uso
              <span class="text-sm lg:text-base font-normal text-gray-400">
                (mostrando <%= [@verses_with_word.count, 5].min %> de <%= @verses_with_word.count %>)
              </span>
            </h4>
            <div class="space-y-3 lg:space-y-4 max-h-60 lg:max-h-80 overflow-y-auto">
              <% @verses_with_word.first(5).each do |verse| %>
                <div class="bg-gray-700 rounded-lg p-3 lg:p-4 border border-gray-600">
                  <div class="flex items-start justify-between mb-2">
                    <span class="text-sm lg:text-base font-semibold text-yellow-400">
                      <%= verse.full_reference %>
                    </span>
                    <a href="<%= bible_verse_path(verse.book.id, verse.chapter.chapter_number, verse.verse_number) %>"
                       class="text-xs lg:text-sm text-blue-400 hover:text-blue-300 underline ml-2"
                       data-action="click->modal#close">
                      Ver verso ‚Üí
                    </a>
                  </div>
                  <% if verse.spanish_text.present? %>
                    <p class="text-sm lg:text-base text-gray-200 leading-relaxed">
                      <%= verse.spanish_text.truncate(200) %>
                    </p>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>

        <!-- Search Related Words -->
        <div class="text-center mt-4 lg:mt-6 pt-4 lg:pt-6 border-t border-gray-600">
          <a href="<%= bible_search_path(q: @strong.greek_word) %>"
             class="inline-block bg-green-600 hover:bg-green-700 text-white font-semibold px-4 lg:px-6 py-2 lg:py-3 rounded-lg text-sm lg:text-base transition-colors duration-200"
             data-action="click->modal#close">
            üîç <%= t('strongs.search_related', word: @strong.greek_word) %>
          </a>
        </div>
      </div>
    </div>
  <% else %>
    <div class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center"
         data-controller="modal"
         data-modal-target="backdrop"
         data-action="click->modal#closeOnOutside keydown@document->modal#handleEscape">

      <div class="bg-gray-800 border-2 border-yellow-400 rounded-xl p-6 lg:p-8 max-w-2xl w-full mx-4 shadow-2xl"
           onclick="event.stopPropagation()">

        <div class="flex justify-between items-center mb-6 lg:mb-8">
          <h2 class="text-2xl lg:text-3xl font-bold text-yellow-400">
            ‚ùå Strong's no encontrado
          </h2>

          <%= link_to "‚úï",
              "#",
              class: "text-gray-400 hover:text-white text-2xl font-bold leading-none",
              title: "Cerrar",
              data: { action: "click->modal#close" } %>
        </div>

        <div class="text-center">
          <p class="text-lg lg:text-xl text-gray-300 mb-6">
            No se encontr√≥ la definici√≥n Strong's para el n√∫mero <%= params[:strong_number] %>.
          </p>
          <p class="text-base lg:text-lg text-gray-400">
            Es posible que este n√∫mero no exista en la base de datos o que haya un error en la referencia.
          </p>
        </div>
      </div>
    </div>
  <% end %>
<% end %> 